SQL> -- ### ASSIGNMENT ON NESTED SUBQUERY
SQL> -- 61. WAQTD 2ND MINIMUM SALARY
SQL> SELECT MIN(SAL)
  2  FROM EMP
  3  WHERE SAL > (SELECT MIN(SAL)
  4  FROM EMP);

  MIN(SAL)                                                                                                                                                                                              
----------                                                                                                                                                                                              
       950                                                                                                                                                                                              

SQL> -- 62. WAQTD 5TH MAXIMUM SALARY
SQL> SELECT MAX(SAL)
  2  FROM EMP
  3  WHERE SAL < (SELECT MAX(SAL)
  4  FROM EMP
  5  WHERE SAL < (SELECT MAX(SAL)
  6  FROM EMP
  7  WHERE SAL < (SELECT MAX(SAL)
  8  FROM EMP
  9  WHERE SAL < (SELECT MAX(SAL) FROM EMP))));

  MAX(SAL)                                                                                                                                                                                              
----------                                                                                                                                                                                              
      2450                                                                                                                                                                                              

SQL> -- 63. WAQTD NAME OF THE EMPLOYEE EARNING 3RD MAXIMUM SALARY
SQL> SELECT ENAME
  2  FROM EMP
  3  WHERE SAL IN (SELECT MAX(SAL)
  4  FROM EMP
  5  WHERE SAL < (SELECT MAX(SAL)
  6  FROM EMP
  7  WHERE SAL < (SELECT MAX(SAL) FROM EMP)));

ENAME                                                                                                                                                                                                   
----------                                                                                                                                                                                              
JONES                                                                                                                                                                                                   

SQL> -- 64. WAQTD EMPNO OF THE EMPLOYEE EARNING 2ND MAXIMUM SALARY
SQL> SELECT EMPNO
  2  FROM EMP
  3  WHERE SAL IN (SELECT MAX(SAL)
  4  FROM EMP
  5  WHERE SAL < (SELECT MAX(SAL) FROM EMP));

     EMPNO                                                                                                                                                                                              
----------                                                                                                                                                                                              
      7788                                                                                                                                                                                              
      7902                                                                                                                                                                                              

SQL> -- 65. WAQTD DEPARTMENT NAME OF THE EMPLOYEE GETTING 4TH MAX SALARY
SQL> SELECT DEPTNO
  2  , DNAME
  3  FROM DEPT
  4  WHERE DEPTNO IN (SELECT DEPTNO
  5  FROM EMP
  6  WHERE SAL = ( SELECT MAX(SAL)
  7  FROM EMP
  8  WHERE SAL < (SELECT MAX(SAL)
  9  FROM EMP
 10  WHERE SAL < (SELECT MAX(SAL)
 11  FROM EMO
 12  WHERE SAL < (SELECT MAX(SAL) FROM EMP))));
WHERE SAL < (SELECT MAX(SAL) FROM EMP))))
                                        *
ERROR at line 12:
ORA-00907: missing right parenthesis 


SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO
  2  , DNAME
  3  FROM DEPT
  4  WHERE DEPTNO IN (SELECT DEPTNO
  5  FROM EMP
  6  WHERE SAL = ( SELECT MAX(SAL)
  7  FROM EMP
  8  WHERE SAL < (SELECT MAX(SAL)
  9  FROM EMP
 10  WHERE SAL < (SELECT MAX(SAL)
 11  FROM EMP
 12* WHERE SAL < (SELECT MAX(SAL) FROM EMP))))
SQL> /
WHERE SAL < (SELECT MAX(SAL) FROM EMP))))
                                        *
ERROR at line 12:
ORA-00907: missing right parenthesis 


SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO
  2  , DNAME
  3  FROM DEPT
  4  WHERE DEPTNO IN (SELECT DEPTNO
  5  FROM EMP
  6  WHERE SAL = ( SELECT MAX(SAL)
  7  FROM EMP
  8  WHERE SAL < (SELECT MAX(SAL)
  9  FROM EMP
 10  WHERE SAL < (SELECT MAX(SAL)
 11  FROM EMP
 12* WHERE SAL < (SELECT MAX(SAL) FROM EMP)))))
SQL> /

    DEPTNO DNAME                                                                                                                                                                                        
---------- --------------                                                                                                                                                                               
        30 SALES                                                                                                                                                                                        

SQL> -- 66. WAQTD DETAILS OF THE EMPLOYEE WHO WAS HIRED 2ND
SQL> SELECT *
  2  FROM EMP
  3  WHERE HIREDATE IN ( SELECT MIN(HIREDATE)
  4  FROM EMP
  5  WHERE HIREDATE > (SELECT MIN(HIREDATE) FROM EMP));

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO                                                                                                                   
---------- ---------- --------- ---------- --------- ---------- ---------- ----------                                                                                                                   
      7499 ALLEN      SALESMAN        7698 20-FEB-81       1600        300         30                                                                                                                   

SQL> -- 67. WAQTD NAME OF THE EMPLOYEE HIRED BEFORE THE LAST EMPLOYEE
SQL> ED
Wrote file afiedt.buf

  1  SELECT ENAME
  2  FROM EMP
  3  WHERE HIREDATE IN ( SELECT MAX(HIREDATE)
  4  FROM EMP
  5* WHERE HIREDATE < (SELECT MAX(HIREDATE) FROM EMP))
SQL> /

ENAME                                                                                                                                                                                                   
----------                                                                                                                                                                                              
SCOTT                                                                                                                                                                                                   

SQL> -- 68. WAQTD LOC OF THE EMPLOYEE WHO WAS HIRED FIRST
SQL> SELECT LOC
  2  FROM DEPT
  3  WHERE DEPTNO IN ( SELECT DEPTNO
  4  FROM EMP
  5  WHERE HIREDATE = ( SELECT MIN(HIREDATE)
  6  FROM EMP));

LOC                                                                                                                                                                                                     
-------------                                                                                                                                                                                           
DALLAS                                                                                                                                                                                                  

SQL> -- 69. WAQTD DETAILS OF THE EMPLOYEE EARNING 7TH MINIMUM SALARY
SQL> SELECT *
  2  FROM EMP
  3  WHERE SAL = (SELECT MIN(SAL) FROM EMP WHERE SAL <
  4  ED
  5  
SQL> ED
Wrote file afiedt.buf

  1  SELECT *
  2  FROM EMP
  3  WHERE SAL = 
  4  (SELECT MIN(SAL) FROM EMP WHERE SAL > 
  5  (SELECT MIN(SAL) FROM EMP WHERE SAL >
  6  (SELECT MIN(SAL) FROM EMP WHERE SAL > 
  7  (SELECT MIN(SAL) FROM EMP WHERE SAL >
  8  (SELECT MIN(SAL) FROM EMP WHERE SAL >
  9  (SELECT MIN(SAL) FROM EMP WHERE SAL >
 10* (SELECT MIN(SAL) FROM EMP)))))))
SQL> /

     EMPNO ENAME      JOB              MGR HIREDATE         SAL       COMM     DEPTNO                                                                                                                   
---------- ---------- --------- ---------- --------- ---------- ---------- ----------                                                                                                                   
      7499 ALLEN      SALESMAN        7698 20-FEB-81       1600        300         30                                                                                                                   

SQL> -- 70. WAQTD DNAME OF THE EMPLOYEE GETTING 2ND MAXIMUM SALARY
SQL> ED
Wrote file afiedt.buf

  1  SELECT DNAME
  2  FROM DEPT
  3  WHERE DEPTNO IN
  4  (SELECT DEPTNO FROM EMP WHERE SAL = 
  5  (SELECT MAX(SAL) FROM EMP WHERE SAL <
  6* (SELECT MAX(SAL) FROM EMP)))
SQL> /

DNAME                                                                                                                                                                                                   
--------------                                                                                                                                                                                          
RESEARCH                                                                                                                                                                                                

SQL> SPOOL OFF
