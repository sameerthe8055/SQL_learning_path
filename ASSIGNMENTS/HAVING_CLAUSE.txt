### ASSIGNMENT QUESTIONS ON HAVING CLAUSE

1. WAQTD DNO AND NUMBER OF EMP WORKING IN EACH DEPT IF THERE ARE AT LEAST 2 CLERKS IN EACH DEPT  
2. WAQTD DNO AND TOTAL SALARY NEEDED TO PAY ALL EMP IN EACH DEPT IF THERE ARE AT LEAST 4 EMP IN EACH DEPT  
3. WAQTD NUMBER OF EMP EARNING SAL MORE THAN 1200 IN EACH JOB AND THE TOTAL SAL NEEDED TO PAY EMP OF EACH JOB MUST EXCEED 3800  
4. WAQTD DEPTNO AND NUMBER OF EMP WORKING ONLY IF THERE ARE 2 EMP WORKING IN EACH DEPT AS MANAGER  
5. WAQTD JOB AND MAX SAL OF EMP IN EACH JOB IF THE MAX SAL EXCEEDS 2600  
6. WAQTD THE SALARIES WHICH ARE REPEATED IN EMP TABLE  
7. WAQTD THE HIREDATE WHICH ARE DUPLICATED IN EMP TABLE  
8. WAQTD AVG SALARY OF EACH DEPT IF AVG SAL IS LESS THAN 3000  
9. WAQTD DEPTNO IF THERE ARE AT LEAST 3 EMP IN EACH DEPT WHOSE NAME HAS CHARACTER 'A' OR 'S'  
10. WAQTD MIN AND MAX SALARIES OF EACH JOB IF MIN SAL IS MORE THAN 1000 AND MAX SAL IS LESS THAN 5000  


SQL> -- 1. WAQTD DNO AND NUMBER OF EMP WORKING IN EACH DEPT IF THERE ARE AT LEAST 2 CLERKS IN EACH DEPT
SQL> SELECT DEPTNO, COUNT(*)
  2  FROM EMP
  3  GROUP BY DEPTNO
  4  HAVING COUNT( CASE WHEN JOB = 'CLERK' THEN 1 END) > 1;

    DEPTNO   COUNT(*)
---------- ----------
        20          5                                                                                                    

SQL> -- 2. WAQTD DNO AND TOTAL SALARY NEEDED TO PAY ALL EMP IN EACH DEPT IF THERE ARE AT LEAST 4 EMP IN EACH DEPT
SQL> SELECT DEPTNO, SUM(SAL)
  2  FROM EMP
  3  GROUP BY DEPTNO
  4  HAVING COUNT(*) > 3;

    DEPTNO   SUM(SAL)                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
        30       9400                                                                                                                                                                                   
        20      10875                                                                                                                                                                                   

SQL> -- 3. WAQTD NUMBER OF EMP EARNING SAL MORE THAN 1200 IN EACH JOB AND THE TOTAL SAL NEEDED TO PAY EMP OF EACH JOB MUST EXCEED 3800
SQL> SELECT COUNT( CASE WHEN SAL > 1200 THEN 1 END) AS EMP_COUNT, SUM(SAL), JOB
  2  FROM EMP
  3  GROUP BY JOB
  4  HAVING SUM(SAL) >3800;

 EMP_COUNT   SUM(SAL) JOB
---------- ---------- ---------
         1       4150 CLERK
         4       5600 SALESMAN
         1       5000 PRESIDENT
         3       8275 MANAGER
         2       6000 ANALYST


SQL> -- 4. WAQTD DEPTNO AND NUMBER OF EMP WORKING ONLY IF THERE ARE 2 EMP WORKING IN EACH DEPT AS MANAGER
SQL> SELECT DEPTNO, COUNT(*)
  2  FROM EMP
  3  GROUP BY DEPTNO
  4  HAVING COUNT(CASE WHEN JOB = 'MANAGER' THEN 1 END) = 2;

no rows selected

SQL> SELECT DEPTNO, JOB
  2  FROM EMP
  3  WHERE JOB = 'MANAGER';

    DEPTNO JOB                                                                                                                                                                                          
---------- ---------                                                                                                                                                                                    
        20 MANAGER                                                                                                                                                                                      
        30 MANAGER                                                                                                                                                                                      
        10 MANAGER                                                                                                                                                                                      

SQL> -- 5. WAQTD JOB AND MAX SAL OF EMP IN EACH JOB IF THE MAX SAL EXCEEDS 2600
SQL> ED
Wrote file afiedt.buf

  1  SELECT JOB, MAX(SAL)
  2  FROM EMP
  3  GROUP BY JOB
  4* HAVING MAX(SAL) > 2600
SQL> /

JOB         MAX(SAL)                                                                                                                                                                                    
--------- ----------                                                                                                                                                                                    
PRESIDENT       5000                                                                                                                                                                                    
MANAGER         2975                                                                                                                                                                                    
ANALYST         3000                                                                                                                                                                                    

SQL> -- 6. WAQTD THE SALARIES WHICH ARE REPEATED IN EMP TABLE
SQL> SELECT COUNT(*), SAL
  2  FROM EMP
  3  GROUP BY SAL
  4  HAVING COUNT(*) > 1;

  COUNT(*)        SAL                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
         2       1250                                                                                                                                                                                   
         2       3000                                                                                                                                                                                   

SQL> -- 7. WAQTD THE HIREDATE WHICH ARE DUPLICATED IN EMP TABLE
SQL> SELECT HIREDATE
  2  FROM EMP
  3  GROUP BY HIREDATE
  4  HAVING COUNT(HIREDATE) > 1;

HIREDATE                                                                                                                                                                                                
---------                                                                                                                                                                                               
03-DEC-81                                                                                                                                                                                               

SQL> -- 8. WAQTD AVG SALARY OF EACH DEPT IF AVG SAL IS LESS THAN 3000
SQL> SELECT AVG(SAL), DEPTNO
  2  FROM EMP
  3  GROUP BY DEPTNO
  4  HAVING AVG(SAL) < 3000;

  AVG(SAL)     DEPTNO                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
1566.66667         30                                                                                                                                                                                   
      2175         20                                                                                                                                                                                   
2916.66667         10                                                                                                                                                                                   

SQL> --9. WAQTD DEPTNO IF THERE ARE AT LEAST 3 EMP IN EACH DEPT WHOSE NAME HAS CHARACTER 'A' OR 'S'
SQL> ED
Wrote file afiedt.buf

  1  SELECT DEPTNO
  2  FROM EMP
  3  WHERE ENAME LIKE '%A%' OR ENAME LIKE '%S%'
  4  GROUP BY DEPTNO
  5* HAVING COUNT(*) > 2
SQL> /

    DEPTNO                                                                                                                                                                                              
----------                                                                                                                                                                                              
        30                                                                                                                                                                                              
        20                                                                                                                                                                                              

SQL> -- 10. WAQTD MIN AND MAX SALARIES OF EACH JOB IF MIN SAL IS MORE THAN 1000 AND MAX SAL IS LESS THAN 5000
SQL> ED
Wrote file afiedt.buf

  1  SELECT MIN(SAL), MAX(SAL), JOB
  2  FROM EMP
  3  GROUP BY JOB
  4* HAVING MIN(SAL) > 1000 AND MAX(SAL) < 5000
SQL> /

  MIN(SAL)   MAX(SAL) JOB                                                                                                                                                                               
---------- ---------- ---------                                                                                                                                                                         
      1250       1600 SALESMAN                                                                                                                                                                          
      2450       2975 MANAGER                                                                                                                                                                           
      3000       3000 ANALYST                                                                                                                                                                           

SQL> SPOOL OFF
