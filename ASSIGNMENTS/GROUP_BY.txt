### ASSIGNMENT QUESTIONS ON GROUP BY

1. WAQTD NUMBER OF EMPLOYEES WORKING IN EACH DEPARTMENT EXCEPT PRESIDENT  
2. WAQTD TOTAL SALARY NEEDED TO PAY ALL THE EMPLOYEES IN EACH JOB  
3. WAQTD NUMBER OF EMPLOYEES WORKING AS MANAGER IN EACH DEPARTMENT  
4. WAQTD AVG SALARY NEEDED TO PAY ALL THE EMPLOYEES IN EACH DEPARTMENT EXCLUDING THE EMPLOYEES OF DEPTNO 20  
5. WAQTD NUMBER OF EMPLOYEES HAVING CHARACTER 'A' IN THEIR NAMES IN EACH JOB  
6. WAQTD NUMBER OF EMPLOYEES AND AVG SALARY NEEDED TO PAY THE EMPLOYEES WHOSE SALARY IS GREATER THAN 2000 IN EACH DEPT  
7. WAQTD TOTAL SALARY NEEDED TO PAY AND NUMBER OF SALESMEN IN EACH DEPT  
8. WAQTD NUMBER OF EMPLOYEES WITH THEIR MAXIMUM SALARIES IN EACH JOB  
9. WAQTD MAXIMUM SALARIES GIVEN TO AN EMPLOYEE WORKING IN EACH DEPT  
10. WAQTD NUMBER OF TIMES THE SALARIES PRESENT IN EMPLOYEE TABLE  



SQL> -- 1. WAQTD NUMBER OF EMPLOYEES WORKING IN EACH DEPARTMENT EXCEPT PRESIDENT
SQL> SELECT COUNT(*), DEPTNO
  2  FROM EMP
  3  WHERE JOB != 'PRESIDENT'
  4  GROUP BY DEPTNO;

  COUNT(*)     DEPTNO                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
         6         30                                                                                                                                                                                   
         5         20                                                                                                                                                                                   
         2         10                                                                                                                                                                                   

SQL> -- 2. WAQTD TOTAL SALARY NEEDED TO PAY ALL THE EMPLOYEES IN EACH JOB
SQL> SELECT SUM(SAL), JOB
  2  FROM EMP
  3  GROUP BY JOB;

  SUM(SAL) JOB                                                                                                                                                                                          
---------- ---------                                                                                                                                                                                    
      4150 CLERK                                                                                                                                                                                        
      5600 SALESMAN                                                                                                                                                                                     
      5000 PRESIDENT                                                                                                                                                                                    
      8275 MANAGER                                                                                                                                                                                      
      6000 ANALYST                                                                                                                                                                                      

SQL> -- 3. WAQTD NUMBER OF EMPLOYEES WORKING AS MANAGER IN EACH DEPARTMENT
SQL> SELECT COUNT(*), DEPTNO
  2  FROM EMP
  3  WHERE JOB = 'MANAGER'
  4  GROUP BY DEPTNO;

  COUNT(*)     DEPTNO                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
         1         30                                                                                                                                                                                   
         1         20                                                                                                                                                                                   
         1         10                                                                                                                                                                                   

SQL> -- 4. WAQTD AVG SALARY NEEDED TO PAY ALL THE EMPLOYEES IN EACH DEPARTMENT EXCLUDING THE EMPLOYEES OF DEPTNO 20
SQL> SELECT AVG(SAL), DEPTNO
  2  FROM EMP
  3  WHERE DEPTNO != 20
  4  GROUP BY DEPTNO;

  AVG(SAL)     DEPTNO                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
1566.66667         30                                                                                                                                                                                   
2916.66667         10                                                                                                                                                                                   

SQL> -- 5. WAQTD NUMBER OF EMPLOYEES HAVING CHARACTER 'A' IN THEIR NAMES IN EACH JOB
SQL> SELECT COUNT(*), JOB
  2  FROM EMP
  3  WHERE ENAME LIKE '%A%'
  4  GROUP BY JOB;

  COUNT(*) JOB                                                                                                                                                                                          
---------- ---------                                                                                                                                                                                    
         3 SALESMAN                                                                                                                                                                                     
         2 CLERK                                                                                                                                                                                        
         2 MANAGER                                                                                                                                                                                      

SQL> -- 6. WAQTD NUMBER OF EMPLOYEES AND AVG SALARY NEEDED TO PAY THE EMPLOYEES WHOSE SALARY IS GREATER THAN 2000 IN EACH DEPT
SQL> SELECT COUNT(*) AS NUM_OF_EMPS, AVG(SAL), DEPTNO
  2  FROM EMP
  3  WHERE SAL > 2000
  4  GROUP BY DEPTNO;

NUM_OF_EMPS   AVG(SAL)     DEPTNO                                                                                                                                                                       
----------- ---------- ----------                                                                                                                                                                       
          1       2850         30                                                                                                                                                                       
          3 2991.66667         20                                                                                                                                                                       
          2       3725         10                                                                                                                                                                       

SQL> --7. WAQTD TOTAL SALARY NEEDED TO PAY AND NUMBER OF SALESMEN IN EACH DEPT
SQL> SELECT SUM(SAL), COUNT(*), DEPTNO
  2  FROM EMP
  3  WHERE JOB = 'SALESMAN'
  4  GROUP BY DEPTNO;

  SUM(SAL)   COUNT(*)     DEPTNO                                                                                                                                                                        
---------- ---------- ----------                                                                                                                                                                        
      5600          4         30                                                                                                                                                                        

SQL> -- 8. WAQTD NUMBER OF EMPLOYEES WITH THEIR MAXIMUM SALARIES IN EACH JOB
SQL> SELECT COUNT(*), MAX(SAL), JOB
  2  FROM EMP
  3  GROUP BY JOB;

  COUNT(*)   MAX(SAL) JOB                                                                                                                                                                               
---------- ---------- ---------                                                                                                                                                                         
         4       1300 CLERK                                                                                                                                                                             
         4       1600 SALESMAN                                                                                                                                                                          
         1       5000 PRESIDENT                                                                                                                                                                         
         3       2975 MANAGER                                                                                                                                                                           
         2       3000 ANALYST                                                                                                                                                                           

SQL> -- 9. WAQTD MAXIMUM SALARIES GIVEN TO AN EMPLOYEE WORKING IN EACH DEPT
SQL> SELECT MAX(SAL), DEPTNO
  2  FROM EMP
  3  GROUP BY DEPTNO;

  MAX(SAL)     DEPTNO                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
      2850         30                                                                                                                                                                                   
      3000         20                                                                                                                                                                                   
      5000         10                                                                                                                                                                                   

SQL> -- 10. WAQTD NUMBER OF TIMES THE SALARIES PRESENT IN EMPLOYEE TABLE
SQL> SELECT COUNT(*), SAL
  2  FROM EMP
  3  GROUP BY SAL;

  COUNT(*)        SAL                                                                                                                                                                                   
---------- ----------                                                                                                                                                                                   
         1       2450                                                                                                                                                                                   
         1       5000                                                                                                                                                                                   
         1       1300                                                                                                                                                                                   
         2       1250                                                                                                                                                                                   
         1       2850                                                                                                                                                                                   
         1       2975                                                                                                                                                                                   
         1       1100                                                                                                                                                                                   
         2       3000                                                                                                                                                                                   
         1        800                                                                                                                                                                                   
         1       1600                                                                                                                                                                                   
         1       1500                                                                                                                                                                                   
         1        950                                                                                                                                                                                   

12 rows selected.

SQL> SPOOL OFF
